<svg width="1000" height="520" viewBox="0 0 1000 520" xmlns="http://www.w3.org/2000/svg">
  <defs>

    <!-- Background -->
    <linearGradient id="bgGradA" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#020617"/>
      <stop offset="100%" stop-color="#020617"/>
    </linearGradient>

    <!-- Arrowhead -->
    <marker id="arrowA" markerWidth="12" markerHeight="12" refX="6" refY="3" orient="auto">
      <path d="M0,0 L12,3 L0,6" fill="#38BDF8"/>
    </marker>

    <style><![CDATA[
      /* flowing request paths */
      .request-line {
        stroke: #38BDF8;
        stroke-width: 4;
        stroke-linecap: round;
        stroke-dasharray: 14 10;
        animation: reqFlow 2.6s linear infinite;
      }
      @keyframes reqFlow {
        to { stroke-dashoffset: -48; }
      }

      /* service pulses */
      .svc {
        animation: svcPulse 3.5s ease-in-out infinite;
      }
      @keyframes svcPulse {
        0%   { transform: scale(1);   opacity: 0.8; }
        50%  { transform: scale(1.05);opacity: 1.0; }
        100% { transform: scale(1);   opacity: 0.8; }
      }

      /* staggered hops */
      .hopA { animation-delay: 0.2s; }
      .hopB { animation-delay: 0.4s; }
      .hopC { animation-delay: 0.6s; }

      /* mesh oscillation */
      .meshBox {
        animation: meshOsc 6s ease-in-out infinite;
      }
      @keyframes meshOsc {
        0%   { stroke-width: 2; opacity: 0.8; }
        50%  { stroke-width: 3.2; opacity: 1.0; }
        100% { stroke-width: 2; opacity: 0.8; }
      }

      /* background sweep */
      .sweep {
        animation: sweepSlide 7s linear infinite;
        opacity: 0.18;
      }
      @keyframes sweepSlide {
        0%   { transform: translateX(-280px); }
        100% { transform: translateX(280px); }
      }
    ]]></style>
  </defs>

  <rect width="1000" height="520" fill="url(#bgGradA)"/>

  <!-- Title -->
  <text x="30" y="50" fill="#F9FAFB" font-size="32" font-family="Inter" font-weight="600">
    MICROSERVICES APPLICATION PATTERN (ANIMATED)
  </text>

  <!-- Ingress -->
  <g>
    <rect x="40" y="110" width="280" height="100" rx="12"
          fill="#020617" stroke="#38BDF8" stroke-width="3"/>
    <text x="55" y="155" fill="#F9FAFB" font-size="20" font-family="Inter">
      Ingress Controller (L7)
    </text>
  </g>

  <!-- AppStack container -->
  <g>
    <rect x="360" y="110" width="600" height="360" rx="14"
          fill="#020617" stroke="#5FB3B3" stroke-width="2"/>
    <g class="sweep">
      <rect x="360" y="110" width="240" height="360" fill="#5FB3B3"/>
    </g>

    <text x="380" y="145" fill="#A0F0E0" font-size="18" font-family="Inter">
      Service Mesh Optional (Linkerd/Istio)
    </text>

    <!-- Mesh outline highlight -->
    <rect x="370" y="160" width="580" height="300" rx="12"
          fill="none" stroke="#5FB3B3" class="meshBox"/>
  </g>

  <!-- Services (pulsing) -->
  <g class="svc">
    <rect x="390" y="180" width="200" height="80" rx="10"
          fill="#020617" stroke="#5FB3B3" stroke-width="2"/>
    <text x="445" y="225" fill="#F9FAFB" font-size="16" font-family="Inter">Service A</text>
  </g>

  <g class="svc hopA">
    <rect x="620" y="180" width="200" height="80" rx="10"
          fill="#020617" stroke="#5FB3B3" stroke-width="2"/>
    <text x="675" y="225" fill="#F9FAFB" font-size="16" font-family="Inter">Service B</text>
  </g>

  <g class="svc hopB">
    <rect x="390" y="290" width="200" height="80" rx="10"
          fill="#020617" stroke="#5FB3B3" stroke-width="2"/>
    <text x="445" y="335" fill="#F9FAFB" font-size="16" font-family="Inter">Service C</text>
  </g>

  <g class="svc hopC">
    <rect x="620" y="290" width="200" height="80" rx="10"
          fill="#020617" stroke="#5FB3B3" stroke-width="2"/>
    <text x="675" y="335" fill="#F9FAFB" font-size="16" font-family="Inter">Service D</text>
  </g>

  <!-- Traffic Flows -->

  <!-- Ingress → A -->
  <line x1="320" y1="160" x2="390" y2="220"
        class="request-line" marker-end="url(#arrowA)"/>

  <!-- A → B -->
  <line x1="590" y1="220" x2="620" y2="220"
        class="request-line" marker-end="url(#arrowA)"/>

  <!-- B → C -->
  <line x1="720" y1="260" x2="590" y2="290"
        class="request-line" marker-end="url(#arrowA)"/>

  <!-- C → D -->
  <line x1="590" y1="330" x2="620" y2="330"
        class="request-line" marker-end="url(#arrowA)"/>

</svg>
